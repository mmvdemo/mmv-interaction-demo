<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Matrix visualization</title>
    </head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/5.1.3/pixi.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/5.16.0/d3.min.js"></script>
    <script src="https://d3js.org/d3-color.v1.min.js"></script>
    <script src="https://d3js.org/d3-interpolate.v1.min.js"></script>
    <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
    <script src="https://cdn.rawgit.com/Keyang/node-csvtojson/d41f44aa/browser/csvtojson.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <body>
        <div>
            <select id="dataType">
                <option value="RANDOM">random data</option>
                <option value="US">US migration data</option>
            </select>
            <label for="nodeCnt"> node count(for random data): </label>
            <input type="text" id="nodeCnt" value="51"></input>
            <button id="submit">submit</button>
        </div>
        <div>
            <select id="technique">
                <option value="cartesianlens">cartesian lens</option>
                <option value="tablelens_stretch">table lens(stretch)</option>
                <option value="tablelens_step">table lens(step)</option>
                <option value="fisheyelens_inside">fisheye lens(inside)</option>
                <option value="fisheyelens_outside">fisheye lens(outside)</option>
                <option value="zoom">zoom and pan</option>
            </select>
        </div>
        <div class="slidecontainer" id="sliderContainer">
        </div>
        <script type="text/javascript">
            var getValue;
            var destinations=[];
            //var data={};
            var timeStart=2005,timeEnd=2018;
            var currentTime = timeEnd;
            var input = {
                "dataType":document.getElementById("dataType"),
                "nodeCnt":document.getElementById("nodeCnt"),
                "technique":document.getElementById("technique"),
                "button":document.getElementById("submit")
            };
            var dataType = input.dataType.options[input.dataType.selectedIndex].value;
            var nodeCnt = Number(input.nodeCnt.value);
            var technique = input.technique.options[input.technique.selectedIndex].value;
        </script>
        <script type="module"> 
            import {loadData} from "./src/data.js";
            import {destroyCartesianLens,loadCartesianLens} from "./src/cartesianLens.js";
            import {destroyTableLens_stretch,loadTableLens_stretch} from "./src/tableLens.js";
            import {destroyTableLens_step,loadTableLens_step} from "./src/tableLens.js";
            import {destroyFisheyeLens_inside,loadFisheyeLens_inside} from "./src/fisheyeLens.js";
            import {destroyFisheyeLens_outside,loadFisheyeLens_outside} from "./src/fisheyeLens.js";
            import {destroyZoom,loadZoom} from "./src/zoom.js";
            loadData();
            let destroyFunc = {
                "cartesianlens":destroyCartesianLens,
                "tablelens_stretch":destroyTableLens_stretch,
                "tablelens_step":destroyTableLens_step,
                "fisheyelens_inside":destroyFisheyeLens_inside,
                "fisheyelens_outside":destroyFisheyeLens_outside,
                "zoom":destroyZoom
            };
            let loadFunc = {
                "cartesianlens":loadCartesianLens,
                "tablelens_stretch":loadTableLens_stretch,
                "tablelens_step":loadTableLens_step,
                "fisheyelens_inside":loadFisheyeLens_inside,
                "fisheyelens_outside":loadFisheyeLens_outside,
                "zoom":loadZoom
            };
            loadFunc[technique]();
            input.technique.onchange = function() {
                let newTechnique = input.technique.options[input.technique.selectedIndex].value;
                destroyFunc[technique]();
                technique = newTechnique;
                loadFunc[newTechnique]();
            }
            input.button.onclick = function() {
                input.button.value = nodeCnt.toString();
                loadData();
                destroyFunc[technique]();
                loadFunc[technique]();
            }
        </script>
    </body>
</html>
